<!DOCTYPE html>
<html>
<head>
    <title>Todo App CRUD</title>
    <style>
        body { font-family: Arial; max-width: 600px; margin: 0 auto; padding: 20px; }
        .todo { border: 1px solid #ccc; padding: 10px; margin: 10px 0; }
        .completed { background-color: #d4edda; }
        button { margin: 0 5px; padding: 5px 10px; }
    </style>
</head>
<body>
    <h1>Todo App</h1>
    
    <div>
        <input type="text" id="nuevoTodo" placeholder="Nueva tarea...">
        <button onclick="crearTodo()">Agregar</button>
    </div>
    
    <h2>Todos:</h2>
    <div id="listaTodos"></div>
    
    <script>
    const BASE_URL = 'https://jsonplaceholder.typicode.com/todos';
    
    // 1. Cargar y mostrar todos inicialmente
    async function cargarTodos() {
        const response = await fetch(`${BASE_URL}?_limit=5`);
        const todos = await response.json();
        mostrarTodos(todos);
    }
    
    // 2. Mostrar en pantalla
    function mostrarTodos(todos) {
        const container = document.getElementById('listaTodos');
        container.innerHTML = '';
        
        todos.forEach(todo => {
            const div = document.createElement('div');
            div.className = `todo ${todo.completed ? 'completed' : ''}`;
            div.innerHTML = `
                <strong>#${todo.id}:</strong> ${todo.title}
                <button onclick="marcarCompletado(${todo.id}, ${!todo.completed})">
                    ${todo.completed ? '‚ùå Desmarcar' : '‚úÖ Completar'}
                </button>
                <button onclick="eliminarTodo(${todo.id})">üóëÔ∏è Eliminar</button>
            `;
            container.appendChild(div);
        });
    }
    
    // 3. Crear nuevo todo
    async function crearTodo() {
        const input = document.getElementById('nuevoTodo');
        const titulo = input.value.trim();
        
        if (!titulo) return;
        
        const response = await fetch(BASE_URL, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                title: titulo,
                completed: false,
                userId: 1
            })
        });
        
        const nuevoTodo = await response.json();
        console.log('Creado:', nuevoTodo);
        
        // Limpiar input
        input.value = '';
        
        // üîÑ RECARGAR la lista para ver el nuevo
        alert(`¬°Creado! ID: ${nuevoTodo.id}. Recargando lista...`);
        await cargarTodos(); // ‚Üê ¬°OTRO GET!
    }
    
    // 4. Actualizar todo (marcar completado)
    async function marcarCompletado(id, completado) {
        // Primero obtener el todo actual
        const getResponse = await fetch(`${BASE_URL}/${id}`);
        const todoActual = await getResponse.json();
        
        // Modificar
        todoActual.completed = completado;
        
        // Hacer PUT
        const putResponse = await fetch(`${BASE_URL}/${id}`, {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(todoActual)
        });
        
        const todoActualizado = await putResponse.json();
        console.log('Actualizado:', todoActualizado);
        
        // üîÑ RECARGAR la lista para ver el cambio
        await cargarTodos(); // ‚Üê ¬°OTRO GET!
    }
    
    // 5. Eliminar todo
    async function eliminarTodo(id) {
        await fetch(`${BASE_URL}/${id}`, {
            method: 'DELETE'
        });
        
        console.log(`Eliminado todo #${id}`);
        
        // üîÑ RECARGAR la lista para ver que desapareci√≥
        await cargarTodos(); // ‚Üê ¬°OTRO GET!
    }
    
    // Cargar todos al iniciar
    cargarTodos();
    </script>
</body>
</html>